
MASManager:
    canvas.before:
        Color:
            rgba: background_color
        Rectangle:
            size: self.size
            pos: self.pos
    Screen:
        name: "welcome_screen"
        BoxLayout:
            orientation: "vertical"
            padding: "50dp"
            MLabel:
                text: "Multi-Agent System Simulation"
                font_size: sp(30)
                bold: True
            BoxLayout:
                orientation: "vertical"
                size_hint: None, .8
                width: "200dp"
                pos_hint: {"center_x":.5, "center_y": .5}
                spacing: "20dp"
                BoxLayout:
                    orientation: "horizontal"
                    MLabel:
                        text: "Host"
                        size_hint_x: .2
                        bold: True
                    MInput:
                        id: host_input
                        text: ""
                        pos_hint: {"center_y": .5}
                BoxLayout:
                    orientation: "horizontal"
                    MLabel:
                        text: "Port"
                        size_hint_x: .2
                        bold: True
                    MInput:
                        id: port_input
                        text: "10001"
                        pos_hint: {"center_y": .5}
                BoxLayout:
                Button:
                    text: "connect"
                    size_hint_x: 1.5
                    size_hint_y: None
                    height: dp(50)
                    pos_hint: {"center_x": .5}
                    on_release:
                        root.change_screens("simulation_screen", host_input.text, port_input.text)

    Screen:
        name: "simulation_screen"
        BoxLayout:
            orientation: "horizontal"
            ScrollView:
                SimulationArea:
                    id: simulation_canvas
                    size_hint_x: None
                    width: self.parent.width + dp(100)
            BoxLayout:
                orientation: "vertical"
                size_hint_x: None
                width: "100dp"
                Console:
                    id: sexy_console
                # DashBoard:
                BreakButton:
                    text: "Simulate"
            

<SimulationArea>:
    #:set branch_hint_1 .3
    #:set branch_hint_2 .55
    #:set branch_hint_3 .82
    LineWidget:
    LineCap:
        pos_hint: {"center_y": .5, "right": 1.}
    LineWidget:
        horizontal: False
        size_hint_x: None
        width: "10dp"
        size_hint_y: .4
        pos_hint: {"y": 0.5, "center_x": branch_hint_1}
    LineWidget:
        horizontal: False
        size_hint_x: None
        width: "10dp"
        size_hint_y: .4
        pos_hint: {"top": 0.5, "center_x": branch_hint_2}
    LineWidget:
        horizontal: False
        size_hint_x: None
        width: "10dp"
        size_hint_y: .4
        pos_hint: {"top": 0.5, "center_x": branch_hint_3}
    SourceWidget:
        id: SOURCE33V
        pos_hint: {"center_y": .5, "x": 0}
        state: True
    SourceWidget:
        id: DG1
        text: "DG1"
        pos_hint: {"top": .1, "center_x": branch_hint_2}
        state: True
    SourceWidget:
        id: DG2
        text: "DG2"
        pos_hint: {"top": .1, "center_x": branch_hint_3}
    CBWidget:
        id: CB9B
        pos_hint: {"y": .11, "center_x": branch_hint_3}
    CBWidget:
        id: CB9A
        pos_hint: {"center_y": .3, "center_x": branch_hint_3}
    CBWidget:
        id: CB8A
        pos_hint: {"top": .49, "center_x": branch_hint_3}
    CBWidget:
        id: CB4B
        pos_hint: {"y": .11, "center_x": branch_hint_2}
    CBWidget:
        id: CB4A
        pos_hint: {"center_y": .3, "center_x": branch_hint_2}
        state: True
    CBWidget:
        id: CB3A
        pos_hint: {"top": .49, "center_x": branch_hint_2}
    CBWidget:
        id: CB5A
        pos_hint: {"y": .51, "center_x": branch_hint_1}
    CBWidget:
        id: CB6A
        pos_hint: {"center_y": .7, "center_x": branch_hint_1}
        state: True
    CBWidget:
        id: CB1A
        pos_hint: {"center_y": .5, "center_x": .1}
    CBWidget:
        id: CB1B
        pos_hint: {"center_y": .5, "center_x": .27}
        state: True
    CBWidget:
        id: CB2A
        pos_hint: {"center_y": .5, "center_x": .33}
    CBWidget:
        id: CB2B
        pos_hint: {"center_y": .5, "center_x": .52}
        state: True
    CBWidget:
        id: CB7A
        pos_hint: {"center_y": .5, "center_x": .58}
    CBWidget:
        id: CB7B
        pos_hint: {"center_y": .5, "center_x": .79}
        state: True
    CBWidget:
        id: CB10A
        pos_hint: {"center_y": .5, "center_x": .85}
        state: True
    BusWidget:
        id: B1
        name: "B1"
        center_x: CB1A.center_x + (CB1B.center_x-CB1A.center_x)//2
        center_y: CB1A.center_y
    BusWidget:
        id: B2
        name: "B2"
        center_x: CB2A.center_x + (CB2B.center_x-CB2A.center_x)//2
        center_y: CB2A.center_y
    BusWidget:
        id: B7
        name: "B7"
        center_x: CB7A.center_x + (CB7B.center_x-CB7A.center_x)//2
        center_y: CB7A.center_y
    BusWidget:
        id: B10
        name: "B10"
        center_x: CB10A.right + (self.parent.width - CB10A.right)//2
        center_y: CB2A.center_y
    
    BusWidget:
        id: B3
        name: "B3"
        center_y: CB4A.center_y + (CB3A.center_y-CB4A.center_y)//2
        center_x: CB3A.center_x
        rotate: 270
    BusWidget:
        id: B4
        name: "B4"
        center_y: CB4B.center_y + (CB4A.center_y-CB4B.center_y)//2
        center_x: CB4A.center_x
        rotate: 270
    BusWidget:
        id: B8
        name: "B8"
        center_y: CB9A.center_y + (CB8A.center_y-CB9A.center_y)//2
        center_x: CB8A.center_x
        rotate: 270
    BusWidget:
        id: B9
        name: "B9"
        center_y: CB9B.center_y + (CB9A.center_y-CB9B.center_y)//2
        center_x: CB9A.center_x
        rotate: 270
    BusWidget:
        id: B5
        name: "B5"
        center_y: CB5A.center_y + (CB6A.center_y-CB5A.center_y)//2
        center_x: CB5A.center_x
        rotate: 90
    BusWidget:
        id: B6
        name: "B6"
        pos_hint: {"center_y": .8}
        center_x: CB6A.center_x
        rotate: 90
        state: False

